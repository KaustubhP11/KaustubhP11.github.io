<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Weight-Shared Networks | Kaustubh S. Ponkshe </title> <meta name="author" content="Kaustubh S. Ponkshe"> <meta name="description" content="A study of methods enabling scalable and dynamic neural networks for diverse deployment."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kaustubhp11.github.io/projects/7_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kaustubh</span> S. Ponkshe </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About Me </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Weight-Shared Networks</h1> <p class="post-description">A study of methods enabling scalable and dynamic neural networks for diverse deployment.</p> </header> <article> <h2 id="what-are-weight-shared-networks">What Are Weight-Shared Networks?</h2> <p>Weight-shared networks allow a single model to dynamically support multiple configurations (e.g., varying depths, widths, and layers) for diverse deployment scenarios. By leveraging shared parameters, these networks enable scalable and efficient inference without requiring repeated retraining for different resource or performance constraints.</p> <p>This approach is particularly impactful for deploying large models like GPT, LLaMA, or FLEXTRON on resource-constrained devices, such as mobile phones or edge hardware.</p> <hr> <h2 id="how-do-weight-shared-networks-work">How Do Weight-Shared Networks Work?</h2> <p>Weight-shared networks train a “supermodel” capable of generating sub-networks tailored to specific hardware or application needs. These sub-networks are derived using:</p> <ul> <li> <strong>Subnet Selection Strategies:</strong> Dynamic programming for layer selection and importance-based pruning for neuron selection.</li> <li> <strong>Elastic Architectures:</strong> Adapt depth, width, and resolution to achieve optimal performance within given constraints.</li> <li> <strong>Dynamic Runtime Inference:</strong> Select sub-networks at runtime based on hardware or input requirements.</li> </ul> <p>These methods ensure high adaptability and efficiency, enabling instant deployment of models optimized for accuracy and latency.</p> <hr> <h2 id="key-techniques">Key Techniques</h2> <h3 id="1-amoeballm-knowledge-preserving-subnet-selection">1. <strong>AmoebaLLM: Knowledge-Preserving Subnet Selection</strong> </h3> <ul> <li>Uses <strong>dynamic programming</strong> to identify critical layers while maintaining the knowledge of pre-trained LLMs.</li> <li>Employs <strong>importance-driven metrics</strong> for structured neuron pruning, preserving key features for inference.</li> </ul> <h3 id="2-once-for-all-ofa-progressive-shrinking">2. <strong>Once-for-All (OFA): Progressive Shrinking</strong> </h3> <ul> <li>Trains the largest configuration first and progressively fine-tunes smaller sub-networks.</li> <li>Supports dynamic adaptation of depth, width, and resolution during inference.</li> </ul> <h3 id="3-flextron-elastic-and-input-adaptive-routing">3. <strong>FLEXTRON: Elastic and Input-Adaptive Routing</strong> </h3> <ul> <li>Introduces <strong>elastic MLPs</strong> and multi-head attention layers to dynamically scale resources based on input complexity.</li> <li>Employs a surrogate model for stable routing decisions, ensuring efficient and accurate sub-network selection.</li> <li>Supports both static and dynamic routing mechanisms to optimize for varying hardware and latency constraints.</li> </ul> <h3 id="4-shape-aware-mixture-of-loras-smol">4. <strong>Shape-Aware Mixture of LoRAs (SMoL)</strong> </h3> <ul> <li>Introduces modular adapters activated based on sub-network shapes to mitigate gradient conflicts during fine-tuning.</li> <li>Enables efficient merging of selected configurations into the model weights at deployment.</li> </ul> <hr> <h2 id="benchmarks-and-performance">Benchmarks and Performance</h2> <p>Weight-shared networks have shown significant improvements in efficiency and scalability. For example:</p> <ul> <li> <strong>AmoebaLLM:</strong> Outperforms state-of-the-art (SOTA) LLM compression methods in accuracy-efficiency trade-offs.</li> <li> <strong>FLEXTRON:</strong> Achieves dynamic scaling for transformer architectures, enabling both token-specific and hardware-adaptive optimizations.</li> <li> <strong>OFA:</strong> Achieves high ImageNet accuracy while operating efficiently across diverse hardware platforms.</li> </ul> <h3 id="example-trade-off">Example Trade-Off:</h3> <p>| Subnet Configuration | Accuracy (%) | Latency (s) | |———————–|————–|————-| | Full Model | 85.2 | 1.50 | | Reduced Depth/Width | 82.3 | 0.90 | | Optimized Subnet | 83.5 | 0.95 |</p> <hr> <h2 id="applications">Applications</h2> <h3 id="real-world-use-cases">Real-World Use Cases:</h3> <ul> <li> <strong>Edge AI:</strong> Deploying efficient LLMs on resource-constrained devices like NVIDIA Jetson or mobile GPUs.</li> <li> <strong>Dynamic Model Scaling:</strong> Adjusting model size dynamically based on real-time hardware constraints.</li> <li> <strong>Energy-Efficient AI:</strong> Reducing computational overhead for sustainability-focused AI solutions.</li> </ul> <hr> <h2 id="challenges-and-future-directions">Challenges and Future Directions</h2> <ol> <li> <strong>Gradient Conflicts:</strong> Addressing conflicts during multi-subnetwork fine-tuning.</li> <li> <strong>Scalability:</strong> Extending weight-shared strategies to future LLM architectures.</li> <li> <strong>Robustness:</strong> Ensuring reliability across diverse tasks and hardware.</li> </ol> <hr> <h2 id="explore-more">Explore More</h2> <ul> <li> <strong>Codebase:</strong> <a href="https://github.com/GATECH-EIC/AmoebaLLM" rel="external nofollow noopener" target="_blank">AmoebaLLM GitHub Repository</a> </li> <li> <strong>Related Works:</strong> <a href="https://arxiv.org/abs/1908.09791" rel="external nofollow noopener" target="_blank">Once-for-All Network</a>, <a href="https://arxiv.org/abs/2406.10260" rel="external nofollow noopener" target="_blank">FLEXTRON Paper</a> </li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Kaustubh S. Ponkshe. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>